# Load Balancingμ΄λ€?
>_λ¶€ν•λ¶„μ‚°_ μ΄λΌκ³  λ¶λ¦¬κΈ°λ„ ν•λ” Load Balancingμ€ μ»΄ν“¨ν„° λ„¤νΈμ›ν¬ κΈ°μ μ μΌμΆ…μΌλ΅ μ¤‘μ•™μ²λ¦¬μ¥μΉ νΉμ€ μ €μ¥μ¥μΉμ™€ κ°™μ€ μ»΄ν“¨ν„° μμ›λ“¤μ—κ² μ‘μ—…μ„ λ‚λ„λ” κ²ƒμ„ μλ―Έν•λ‹¤.

#### Reference
- [λ΅λ“λ°Έλ°μ„(Load Balancer)μ κ°λ…κ³Ό νΉμ§•](https://post.naver.com/viewer/postView.nhn?volumeNo=27046347&memberNo=2521903)
- [λ„¤νΈμ›ν¬μ λ¶€ν•λ¶„μ‚°, λ΅λ“λ°Έλ°μ‹± κ·Έλ¦¬κ³  λ΅λ“λ°Έλ°μ„](https://www.stevenjlee.net/2020/06/30/%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%EC%9D%98-%EB%B6%80%ED%95%98%EB%B6%84%EC%82%B0-%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1-load-balancing-%EA%B7%B8/)
- [[10λ¶„ ν…μ½”ν†΅]πΏ μ μ΄λ―Έμ Forward Proxy, Reverse Proxy, Load Balancer](https://youtu.be/YxwYhenZ3BE)
- [λ€μ©λ‰ μ„Έμ…μ„ μ„ν• λ΅λ“λ°Έλ°μ„](https://d2.naver.com/helloworld/605418)

---

## λ” μμ„Έν Load Balancing μ΄λ€?
- μ„λ²„μ— κ°€ν•΄μ§€λ” `λ¶€ν•(=λ΅λ“)`λ¥Ό `λ¶„μ‚°(=λ°Έλ°μ‹±)`ν•΄μ£Όλ” μ¥μΉ λλ” κΈ°μ μ΄λ‹¤.
- ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ν’€(λ¶„μ‚° λ„¤νΈμ›ν¬λ¥Ό κµ¬μ„±ν•λ” μ„λ²„λ“¤μ κ·Έλ£Ή) μ‚¬μ΄μ— μ„μΉν•λ©°, ν• λ€μ μ„λ²„λ΅ λ¶€ν•κ°€ μ§‘μ¤‘λμ§€ μ•λ„λ΅ `νΈλν”½`μ„ `λ¶„μ‚°μ²λ¦¬`ν•΄ κ°κ°μ μ„λ²„κ°€ μµμ μ νΌν¬λ¨Όμ¤λ¥Ό λ³΄μΌ μ μλ„λ΅ ν•λ‹¤.

---

## Load Balancingμ΄ ν•„μ”ν• μ΄μ 
- μ‚¬μ—…μ κ·λ¨κ°€ ν™•μ¥λκ³ , ν΄λΌμ΄μ–ΈνΈμ μκ°€ λμ–΄λ‚κ² λλ©΄ κΈ°μ΅΄ μ„λ²„λ§μΌλ΅λ” μ •μƒμ μΈ μ„λΉ„μ¤κ°€ λ¶κ°€λ¥ν•λ‹¤
- μ΄ κ²½μ°, μ¦κ°€ν• νΈλν”½μ— λ€μ²ν•  μ μλ” λ°©λ²•μ€ ν¬κ² λ‘ κ°€μ§€λ‹¤.
    1. __Scale-Up__ : μ„λ²„ μμ²΄μ μ„±λ¥μ„ λ†’μ΄λ” κ²ƒ
    2. __Scale-Out__ : μ—¬λ¬ λ€μ μ„λ²„λ¥Ό λ‘λ” κ²ƒ
        - __Scale-Out__ λ°©μ‹μ€ μ—¬λ¬ λ€μ μ„λ²„λ΅ νΈλν”½μ„ κ· λ“±ν•κ² λ¶„μ‚°ν•΄μ£Όλ” `λ΅λ“λ°Έλ°μ‹±`μ΄ λ°λ“μ‹ ν•„μ”ν•λ‹¤.

---
## λ΅λ“ λ°Έλ°μ„μ κΈ°λ³Έ λ™μ‘ λ°©μ‹
1. ν΄λΌμ΄μ–ΈνΈμ λΈλΌμ°μ €μ— naver.com μ΄λΌκ³  μ…λ ¥
2. ν΄λΌμ΄μ–ΈνΈμ— μ„¤μ •λ λ©”μΈ DNS μ„λ²„λ΅ naver.comμ IP μ£Όμ†λ¥Ό λ¬Έμ
3. λ©”μΈ DNS μ„λ²„λ” naver.com μ£Όμ†λ¥Ό κ΄€λ¦¬ν•λ” λ³„λ„μ DNS μ„λ²„μ— IP μ£Όμ†λ¥Ό λ¬Έμ
4. λ³„λ„ κ΄€λ¦¬ DNS μ„λ²„λ” λ΅λ“λ°Έλ°μ„μ IP(Virtual IP, L4μ¤μ„μΉλ¥Ό λ™μ‘μ‹ν‚¤λ” μ„λ²„μ IPμ£Όμ†)μ£Όμ†λ¥Ό λ©”μΈ DNS μ„λ²„μ—κ² μ•λ ¤μ¤.
5. λ©”μΈ DNS μ„λ²„λ” νλ“ν• Virtual IPμ£Όμ†λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅
6. ν΄λΌμ΄μ–ΈνΈμ—μ„ λ΅λ“λ°Έλ°μ„μ Virtual IPμ£Όμ†λ΅ HTTP μ”μ²­
7. λ΅λ“ λ°Έλ°μ„λ” λ³„λ„ λ΅λ“λ°Έλ°μ‹± μ•κ³ λ¦¬μ¦μ„ ν†µν•μ—¬ μ„λ²„μ—κ² μ”μ²­μ„ μ „μ†΅
8. μ„λ²„μ μ‘μ—… κ²°κ³Όλ¥Ό λ°›μ€ λ΅λ“λ°Έλ°μ„λ” μ „λ‹¬λ°›μ€ HTTP κ²°κ³Όλ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅


---

## L4 λ΅λ“ λ°Έλ°μ‹±
- [λ³µμµ] L4 κ³„μΈµμ€ IPμ— μν•΄ μ „λ‹¬λλ” ν¨ν‚·μ μ¤λ¥λ¥Ό κ²€μ‚¬ν•κ³  μ¬μ „μ†΅ μ”κµ¬ λ“±μ μ μ–΄λ¥Ό λ‹΄λ‹Ήν•λ” κ³„μΈµμ΄λ‹¤.
- L4 λ΅λ“λ°Έλ°μ„λ” L4 κ²μΈµμ—μ„ λ™μ‘ν•λ” λ΅λ“λ°Έλ°μ„ μ΄λ―€λ΅ λ„¤νΈμ›ν¬ κ³„μΈµμ μ •λ³΄(OP)λ‚ μ „μ†΅ κ³„μΈµμ μ •λ³΄(TCP,UDP)λ¥Ό λ°”νƒ•μΌλ΅ λ΅λ“λ¥Ό λ¶„μ‚°ν•λ‹¤.
- μ¦‰, IP μ£Όμ†λ‚, ν¬νΈ λ²νΈ, MACμ£Όμ†, μ „μ†΅ ν”„λ΅ν† μ½(TCP/UDP) λ“±μ— λ”°λΌ νΈλν”½μ„ λ‚λ„κ³  λ¶„μ‚°μ²λ¦¬ν•λ” κ²ƒμ΄ κ°€λ¥ν•λ‹¤.
- μ„μ™€ κ°™μ€ μ΄μ λ΅ L4μ λ΅λ“λ°Έλ°μ„λ¥Ό CLB(Commection Load Balancer) λλ” SLB(Session Load Balancer)λΌκ³  λ¶€λ¥΄κΈ°λ„ ν•λ‹¤.
- λ°μ΄ν„° μ•μ„ λ³΄μ§€ μ•κ³  ν¨ν‚· λ λ²¨μ—μ„λ§ λ΅λ“λ¥Ό λ¶„μ‚°ν•κΈ° λ•λ¬Έμ— μ†λ„κ°€ λΉ λ¥΄κ³  ν¨μ¨μ΄ λ†’λ‹¤.
- μ„¬μ„Έν• λΌμ°ν…μ΄ λ¶κ°€λ¥ν•μ§€λ§ L7λ΅λ“ λ°Έλ°μ„λ³΄λ‹¤ μ €λ ΄ν•λ‹¤.

---

## L4 λ΅λ“ λ°Έλ°μ‹± μ•κ³ λ¦¬μ¦
- __λΌμ΄λ“ λ΅λΉ__
    - μ„λ²„μ— λ“¤μ–΄μ¨ μ”μ²­μ„ μμ„λ€λ΅ λμ•„κ°€λ©° λ°°μ •ν•λ” λ°©μ‹.
    - ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μμ„λ€λ΅ λ¶„λ°°ν•κΈ° λ•λ¬Έμ— μ—¬λ¬ λ€μ μ„λ²„κ°€ λ™μΌν• μ¤ν™μ„ κ°–κ³  μκ³ , μ„λ²„μ™€μ μ—°κ²°(μ„Έμ…)μ΄ μ¤λ μ§€μ†λμ§€ μ•λ” κ²½μ°μ— ν™μ©ν•κΈ° μ ν•©ν•λ‹¤.

- __κ°€μ¤‘ λΌμ΄λ“λ΅λΉ λ°©μ‹__
    - κ° μ„λ²„μ— κ°€μ¤‘μΉλ¥Ό λ§¤κΈ°κ³  κ°€μ¤‘μΉκ°€ λ†’μ€ μ„λ²„μ— μ”μ²­μ„ μ°μ„ μ μΌλ΅ λ°°μ •ν•λ” λ°©μ‹.
    - μ£Όλ΅ μ„λ²„μ νΈλν”½ μ²λ¦¬ λ¥λ ¥μ΄ μƒμ΄ν• κ²½μ° μ‚¬μ©λλ‹¤.
    - μλ¥Ό λ“¤μ–΄ AλΌλ” μ„λ²„κ°€ 5λΌλ” κ°€μ¤‘μΉλ¥Ό κ°–κ³  BλΌλ” μ„λ²„κ°€ 2λΌλ” κ°€μ¤‘μΉλ¥Ό κ°–λ”λ‹¤λ©΄, λ΅λ“λ°Έλ°μ„λ” λΌμ΄λ“λ΅λΉ λ°©μ‹μΌλ΅ A μ„λ²„μ— 5κ° B μ„λ²„μ— 2κ°μ μ”μ²­μ„ μ „λ‹¬ν•λ‹¤.

- __IP ν•΄μ‹ λ°©μ‹__
    - ν΄λΌμ΄μ–ΈνΈμ IPμ£Όμ†λ¥Ό νΉμ • μ„λ²„λ΅ λ§¤ν•‘ν•μ—¬ μ”μ²­μ„ μ²λ¦¬ν•λ” λ°©μ‹.
    - μ‚¬μ©μμ IPλ¥Ό ν•΄μ‹±ν•΄μ„ λ΅λ“λ¥Ό λ¶„λ°°ν•κΈ° λ•λ¬Έμ— μ‚¬μ©μκ°€ ν•­μƒ λ™μΌν• μ„λ²„λ΅ μ—°κ²°λλ” κ²ƒμ„ λ³΄μ¥ν•λ‹¤. 

- __μµμ† μ—°κ²° λ°©μ‹__
    - μ”μ²­μ΄ λ“¤μ–΄μ¨ μ‹μ μ— κ°€μ¥ μ μ€ μ—°κ²° μƒνƒλ¥Ό λ³΄μ΄λ” μ„λ²„μ— νΈλν”½μ„ λ°°μ •ν•λ” λ°©μ‹.
    - μμ£Ό μ„Έμ…μ΄ κΈΈμ–΄μ§€κ±°λ‚, μ„λ²„μ— λ¶„λ°°λ νΈλν”½λ“¤μ΄ μΌμ •ν•μ§€ μ•μ€ κ²½μ°μ— μ ν•©ν•λ‹¤.


- __μµμ† λ¦¬μ¤ν°νƒ€μ„(Least Response Time Method)__
    - μ„λ²„μ ν„μ¬ μ—°κ²° μƒνƒμ™€ μ‘λ‹µμ‹κ°„μ„ λ¨λ‘ κ³ λ ¤ν•μ—¬ νΈλν”½μ„ λ°°λ¶„ν•λ‹¤. 
    - κ°€μ¥ μ μ€ μ—°κ²° μƒνƒμ™€ κ°€μ¥ μ§§μ€ μ‘λ‹µμ‹κ°„μ„ λ³΄μ΄λ” μ„λ²„μ— μ°μ„ μ μΌλ΅ λ΅λ“λ¥Ό λ°°λ¶„ν•λ” λ°©μ‹μ΄λ‹¤.


---
## L7 λ΅λ“ λ°Έλ°μ‹±
- L4 λ΅λ“λ°Έλ°μ„μ κΈ°λ¥μ„ ν¬ν•¨ν•λ” κ²ƒ λΏλ§ μ•„λ‹λΌ 7κ³„μΈµμ ν”„λ΅ν† μ½(HTTP,SMTP,FTP)μ μ •λ³΄λ¥Ό λ°”νƒ•μΌλ΅ λ΅λ“λ¥Ό λ¶„μ‚°μ²λ¦¬ ν•λ” κ²ƒμ΄ κ°€λ¥ν•λ‹¤.
- λ‹¤μ‹λ§ν•΄ HTTP ν—¤λ”, μΏ ν‚¤ λ“±κ³Ό κ°™μ€ μ‚¬μ©μ μ”μ²­μ„ κΈ°μ¤€μΌλ΅ νΉμ • μ„λ²„μ— νΈλν”½μ„ λ¶„μ‚°ν•λ” κ²ƒμ΄ κ°€λ¥ν•λ‹¤. 
- μ •λ¦¬ν•μλ©΄ ν¨ν‚· λ‚΄μ©μ„ ν™•μΈν•κ³  κ·Έ λ‚΄μ©μ— λ”°λΌ λ΅λ“λ¥Ό νΉμ • μ„λ²„μ— λ¶„λ°°ν•λ” κ²ƒμ΄ κ°€λ¥ν• κ²ƒμ΄λ‹¤.
- νΉμ • κΈ°λ¥μ„ ν•λ” μ”μ²­μ΄ λ“¤μ–΄μ¤λ©΄ κ·Έ μ”μ²­μ„ μ²λ¦¬ν•λ” μ„λ²„λ΅ λ³΄λ‚΄λ” λ” μ„¬μ„Έν• λΌμ°ν…μ΄ κ°€λ¥ν•κ³ , λΉ„μ •μƒμ μΈ νΈλν”½μ„ ν•„ν„°λ§ ν•  μ μλ‹¤.
-λ‹¤λ§, ν¨ν‚·μ λ‚΄μ©μ„ λ³µνΈν™” ν•΄μ•Όν•κΈ° λ•λ¬Έμ— λ” λ§μ€ λΉ„μ©μ΄ λ“ λ‹¤.
---
## L7λ΅λ“λ°Έλ°μ‹± λ°©λ²•
- __URL μ¤μ„μΉ­ λ°©μ‹__
    - νΉμ • ν•μ„ URLλ“¤μ€ νΉμ • μ„λ²„λ΅ μ²λ¦¬ν•λ” λ°©μ‹μ΄λ‹¤.
    - `.../mulgyeol/image` λλ” `../mulgyeol/video`μ™€ κ°™μ€ νΉμ • URLμ„ κ°€μ§„ μ£Όμ†λ“¤μ€ μ„λ²„κ°€ μ•„λ‹ λ³„λ„μ μ €μ¥κ³µκ°„μ— μλ” κ°μ²΄ λ°μ΄ν„°λ΅ λ°”λ΅ μ—°κ²°λλ„λ΅ κµ¬μ„±ν•  μ μλ‹¤.
- __Context μ¤μ„μΉ­ λ°©μ‹__
    - ν΄λΌμ΄μ–ΈνΈκ°€ μ”μ²­ν• νΉμ • λ¦¬μ†μ¤μ— λ€ν•΄ νΉμ • μ„λ²„ λ“±μΌλ΅ μ—°κ²°μ„ ν•΄μ¤„ μ μλ‹¤.
    - μλ¥Ό λ“¤μ–΄, μ΄λ―Έμ§€ νμΌμ κ²½μ° ν™•μ¥μλ¥Ό μ°Έμ΅°ν•μ—¬ λ³„λ„λ΅ κµ¬μ„±λ μ΄λ―Έμ§€ νμΌμ΄ μλ” μ„λ²„/μ €μ¥κ³µκ°„μΌλ΅ μ§μ ‘ μ—°κ²°ν•΄ μ¤„ μ μλ‹¤.
- __μΏ ν‚¤ μ§€μ†μ„±(Persistence with Cookies)__ 
    - μΏ ν‚¤ μ •λ³΄λ¥Ό λ°”νƒ•μΌλ΅ ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²°ν–λ, λ™μΌν• μ„λ²„μ— κ³„μ† ν• λ‹Ήν•΄ μ¤„ μ μλ‹¤.
    - νΉν μ‚¬μ„¤ λ„¤νΈμ›ν¬μ— μλ ν΄λΌμ΄μ–ΈνΈμ IPμ£Όμ†κ°€ κ³µμΈ IPμ£Όμ†λ΅ μΉν™λμ–΄ μ „μ†΅ν•λ” λ°©μ‹μ„ μ§€μ›ν•λ‹¤.(ν—¤λ”μ— ν΄λΌμ΄μ–ΈνΈ IPμ£Όμ†λ¥Ό λ³„λ„λ΅ κΈ°λ΅ν•λ‹¤.)

---
## L4μ™€ L7 λ΅λ“λ°Έλ°μ„μ λΉ„κµ
<p align="center"><img src="./img/LoadBalancing/L4_L7.png"></p><br>

---
## L4/L7 λ΅λ“λ°Έλ°μ„μ μ£Όμ” μ„±λ¥ μ§€ν‘
1. __μ΄λ‹Ή μ—°κ²° μ__
    - μµλ€ μ²λ¦¬κ°€ κ°€λ¥ν• μ΄λ‹Ή TCP μ„Έμ…μ κ°μλ¥Ό μλ―Έν•λ‹¤.
2. __λ™μ‹ μ—°κ²° μ__
    - λ™μ‹μ— μµλ€λ΅ μ„Έμ…μ„ μ μ§€ν•  μ μλ” κ°μλ¥Ό μλ―Έν•λ‹¤.
3. __μ²λ¦¬μ©λ‰__
    - (ν¨ν‚· μμ²΄μ— λ€ν•΄ μ—°κ²°μ΄ μ„±λ¦½λλ”) UDPν”„λ΅ν† μ½μ— λ€ν• λ΅λ“λ°Έλ°μ‹± μ„±λ¥ μ§€ν‘μ΄λ‹¤.
    - λ‹¨μ„λ” bpsλλ” pps(packet per second)λ¥Ό μ‚¬μ©ν•λ‹¤.

---
## [λ€μ©λ‰ μ„Έμ…μ„ μ„ν• λ΅λ“λ°Έλ°μ„](https://d2.naver.com/helloworld/605418)
- μ½μ–΄λ³΄λ©΄ μΆ‹μ„ λ‚΄μ©